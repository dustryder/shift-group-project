{% extends 'base.html' %}

{% block title %}Devices{% endblock %}
{% block content %}


<div class="container">
    <h2> Search Device Table</h2>
    <p> Search for device information here:</p>
    <input class="form-control" id="myInput"  type="text" placeholder="Start typing...">
    <br>
</div>

<form class="form-group"method="post" action="/">
<select class="form-control login-select" name="employee_id" id="employee_id">
{% for employee in employees %}
  <option value={{ employee[0]|string+","+employee[1]+","+employee[2]|string }} {{"selected= 'selected'" if employee[0]|string == employee_id|string else '' }} >{{ employee[1] }}</option>
{% endfor %}
</select>
</div class="align-self-center" > 
<table class= "table table-fixed">
    <thead class="thead-dark">
	<tr>
        <th>Device Name</th>
        <th>Status</th>
        <th>Device Type</th>
        <th>OS Type</th>
        <th>OS Version</th>
        <th>Device Grade</th>
        <th>Device Location</th>
    </tr>
    </thead> 
    
    {% for device in device_table %}
    <tbody id="DeviceTable" class="table-hover">
    <tr>
    {% for field in device[2:] %}

        {% if loop.index == 2 %}

            {% if device[1]|string == employee_id|string %}
                <td hidden-id={{ device[1] }} hidden-name={{ device[3] }} class="text-left"><button class="btn btn-primary btn-block" type="submit" name="device_id" value={{ device[0]|string+","+field }}>Return</button></td>
            {% elif field == None %}
                <td class="text-left"><button class="btn btn-block btn-success" type="submit" name="device_id" value={{ device[0]|string+",available" }}>Borrow</button></td>
            {% else %}
                <td hidden-id={{ device[1] }} hidden-name={{ device[3] }} class="text-left">{{ field }}</td>
            {% endif %}

        {% else %}
        <td class="text-left">{{ field }}</td>
        {% endif %}

    {% else %}

    {% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
</form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#DeviceTable tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
</script>
{% endblock %}
{% block javascript %}
{% endblock %}
